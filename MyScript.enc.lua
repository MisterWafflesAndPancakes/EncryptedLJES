-- Self-decrypting encrypted script
local AES_KEY_HEX = "a830143466b6679ef00e3c9d3b5738b995b010115ff616b054947c4d5081ad85"
local IV_HEX = "fce8c5d9ffebf271cb935870bac583dc"
local CIPHER_HEX = "bdc683848f03d50e2251024b5bbbe698460575e5c39b475538fa46f6d3084f43e41226f9f1329ede2f37ad745fb537e1f01bc905c0c910e52a57592ba17057af009e7762c005e5d7585eacec0217b351e4f2064655b220c09365ba9c122b6e4854dbf07a505dadd29c23cfce0d4ea8025656de1aa9ec19445db4cc9f38c563da522be39021886d991faeb2a474ff9e7d7a005fa6a913613f8dea39176b422028b75af3af867e7d73992daa6ab43739513d06b7b336174ccc843d2d4de87b094be804a9498cf74e761c592cf527ca412ecc360108c6f6108d48c41c2c5ac6cb1891718042e3ba7ca2714babd79d338807960a7f3f7b9ede923d564d49431630591ceddb5f59644a75bf9148980e5a83b4880a6b76c29875e322fd5da4b74d09eb2ca709523e079208539f32e9186e090e311bccd4448bd8bfb454d5a56ca27d29d84871673604ef5463a4454260bcb027bfcbdcf37f79b92a7247cbed87ddadf2f77d168110f2b92174e594563ea64133daeaaa199ee555a716f1f4975f8fff5e2ca65b011cb4a9b3b1acaafc80dcef74718264340d8ffa75037ace22f718102733968d301eab72278102f53aad836015542690631579bf5db5b40b606c9f74d4edbc4f4ac9e7266cc5373b644056576093827f695d9005240a77ec6ecf6620faed7cb732617d8bcec891108ad81150316d2161241bbf7d2db6c81a7b05490bdb7bf7cb99253372910271f20970fd0798fd8c4b2922b02074285dbec53fcf10c9233a6c5365ec563f66843a5ae5abf7b8773520300b3f06e538270b00d05f7cf841f50903c74d6ceb4ca12523d092aebd5068e0d544397a8ae779d46fe366180a9a9dad8f3b78a2c6315a26e628fc254d55d29bdfeb3dc3c28bcb87acbf614bb9c8dad799b5b2027ad0e7f276c855bb0f372416c896c5549230c3ea5cb333caa778e798f7adf857d9829eae31b6176dec1ebd8ea8397efd7b1e5e647beee6f6c70b432daacc49fb4e80cd1996d6e995a83739396da6b1ecd921b8fab42076d1c899f18ddc203f5df506bc98420da2dd85add8cfc192dbc021ea42ab8761f844d7060d3d5d8e77537964e2eae69e61ca39bbf100b65b66119a10c76ba93709f796faf47a59c9c402747c3355ff4bfca03ebaf1ac9f248d33d35da2853d1d43bee6b766a6ccde99401860d3abf41081ad6c9d3a59033f2c8b69c7dc39e87496a9118b829fb72c29293c2b97f2c6abb9b9ee16ca54dec928d7ef306b57af6bbde7f434f55604b84d5f98a2424a72c9952abe287dec170a7b1f36743fcd15825978e27d1c505a7eb7610031805c0221303e5d2da13223f6346dfe64e134a89808fede22622ef74d9ba8bf986ffbc2aff66f2e161c1eb479f0ca31141ea636f787ff559ce603c777ef7e1f83bfbd8752af97f4c298db2f4fa314624d7a4673dbb99d77791d75a0865901275fa1daef4cb5d6fd390791b24f5f02532e41793ee4abd9d37950644ad5c96086c0b916ca71a7bb6bf5198cfa739f933463fd3ed69d34ccae6810bce9d812277adfc808d0e99acd81c81bf9d1bc86fa6cf6aa01590cdbd211ac88d42d1ee21a0ef6ce4af5b5d634e7687c6385a12b313a1464bfc8e814b9824c5a6b3b1ce14ff96ff515b5149224a8a1e6ac5bb62da969ebed95739e9397732dc1f71b0b83bcabde5461296125249359dea5a48c597c3bfec9e44a69a0ea78031bd7d2178726100b5c8bf095e4600b2c03b7d7e9b60ed82e324beba2378ec46b2aac8f7174a7e603f1c9ba9637d53ffa67bebeb8c711f2d92a0cb2eac870d62127f7cb1e234552682574810dc9721236cb7f111b0291840ab0610ad9f4859bf362a28383b86164267d4fe30dd8fdb06476a7b23e2d5d9666eca55e73fbc4a295237581f7f60e2d57cdd59c54a6af7f87aa89dd95815349cf776a94859b8d948817ee012d194de51219a9e34fe9b88e1fb4f1257bd89b385053add50cd5dd7feea5cd9e9c9b5d50f775b56f8128eab98d763aaa0fe6c6874ff82b9aec83e74413a16000b819fd36ccb2c8a1edfc81921d5adf824139c2c8f5608b4d12eb3c783b88ece1e363086670fe4e69cc3cc32cebf3fa551ac0544f0620a928ada31b04647efa45daa769898e17de8052eed56068d3ae52b7b8c585f246347be19295b3173c2646b92ed2401be650f90dc9afe38c7cdad902bc3a35ba6247835ec2c93a3388b6bfc5de9a44e9c00739648abd8318a83a90c78ae4a1c07b800b61cada6fe45579c82380b7c8326e8f9e46d1a61f4d708534ecd42e28abe2ccc4ee8b4cd3f94d492fa350699ca1ecb77a36f81f5cabc469a39e6cbde470e86f75ab9007507b08fe6e48c7d6aedfce80e88dc8881f1c86454b87ae3f847e2e57a08167ca61e7b04b7d6eb48283246e410db348fbb7b5c89f9f2e10a0ca59fe4b76a597c4695179f3be905cc5bfeed648d82b7a93cce2eb817fc28c3e4cfb5ccf1a56870e211910a69dd67481e978a0432744b04dab86cfa3aaf08bd2bfff5df23b5360b9c630ce375c2176a7b4cc82fc32bde7251b86f934e84ddb1778b5229b823f94bb6bf51f09baa409bfdef8a395a94dd36b74804604a0a50ec93815779a5a8dd54aadd4fbf4ba09fba4b0a21314fa4e7d43725beb559a020fea9707fda8b722634bc42e40c33a99a7cd0281055d7d0899eaf207bb67b8ed2bd956301fc35d438c72c93fbaa990d83fb09a8481fde92a29eb0e8f185ce7d33012c198a502bd7c5cde5fa766cf311488e5d0825ad3143069af39039a59c5802db23af938392937be27120f60241f4404622b9e4629223a25389b6f7a55eaa149239e498d07e85460bfcf9c6090e4e28b22988e2b4480182a9309f98a755368e28b67184fc1c983891429d42f32230a2c42b6d525c86dcb3f16e553b8af76879bf90e59503352b2c8e482274d45ef3582aed6d4098a17a78d26266672191855d8f1e00713fa20e71dd4e0d9cf7a75d5583b08e53662dfec2f403d7c38d949e1fa1f8f132c6cf7d369372ddf60ab9a36619011d1debc12ab50b4b51729b4b7c0cfe8c82212ebf867c585ea12d531896769df1a65979ac4225fa30a950aa107ac39362c229ce1a3fa292fe93de01c599af1246845f30c32f5ac9148c8141cd04890fbf1219d5943d2219161b95dd3488c9c98ce8c63d6d0bb78d262b4f0a4fdd238f6e82e372bd1c7f80b114833d89935b9011b7a9736703a673241ace5df746f1bdf1552f1390cf98fbb697566ec3d9e60e0319d6d26437537f42f8db274eb7a44198ccc7d92b5702449d6289dcd426b09d41f15ff1a74be23a3afe760e7881a3e25b869bc49c760b7b6559ab9cecfcc36daa1fbdfd8986b3223885721f3cdcd3bf0c8f406b6bb68a9b1483510eb49c837a4af95a503ea84aab2dee27502862b4113e75fab1cd01b73fa21cac19aa227e07f1987058a3a16106e62aaf6341a5b95aaab0a58e7dded167008748eaebaa7b68077b8a76bf808e043303ec5d4b437ea58d63efe9817bbe73463b75d03f5a181c8081798657fd667fda3b7ad08ec711bc738e5516485997860954b6ccf759fa9224ad7cd17eb9fad0096e9270c1a09a675621d2def67d94a22b31b37504490216fd1ca5e24e75d00f1b7263f4590d88be288de4fe734ad5cb93c18c1e71ea698387e0dac77bfe776a75b6540c96f4d8aee10d92655d402be09744b9409914f1df78baf7da27d09fa4e7dedf927037d68e53df99f4d2ff04969a1d0e4b64eae0768267f98d3e82a70c0bdc696d1707b3397b27b6399feb17357bbd5c890824a1a0f335b548794559755525a95e6999f2592cf65c5876b1777eaaf6dcaba1d63db7aa7fa53dc17b64a21de9fdf7e91a50eb209585d67fca8050041ac37bab62601b2ccfd84fb955286e78ff348bd003ee48498c4a7f998c60d97c8dc143e66faccd37f222ab776b5e1542b56ab64f837197f022d4c2d1fa6382cb44fffc1e057852acec1a8b29b488e3759cc05cd6107aa0c7a71a48191345a485e1c616322f9b16538d7b725871661e5092a5cf500561ed8f97ca8707e0c1d3ebe89363d17c9964ee6cdf899b59a01839f4a4d2dba884287282c7434279ce80997f68c0d59e309cf6cbb56ba4dcbe2c48c15f93cc98071324476bbfeb9993941accff2401350079345f1fdf504fa1916cba3a73f92b2f95af3fd6f402e97e0b1bca635800a6e30e813eaf239eda93d5cb611bcf144004253a3e7be1c80a2a865ab1f25051d905e2b0d64e74ae159fd7067e710d9ebeafa7c3618dc06cc3a4f34d70d337595dfbb9332cbd6ed45b5e97283328da6d1d585a52bf20d1c6d87f81c837bc73fa013761f69abb7ed7d3f480a7e67835d12f6e58a5de19ec411f946fbf9b12b455aa4b05cefca5ce3f95bb8974780ee1e913d376672a5feced8bd396b5eca0a276cb3e5fa6aab3a003fd35ef6d091e7a894fc6099f98a4678e9b45f54f9b2c7ac4c237e20dc8152153e05dce9b654d938ee97e4dc4dfb03f4227020eed14926743ee248e51286250add05ee94c7ff349c379852cb3d1a66a62e3cf721c785037284cbac2798622d954aa7fd84ff996065773a99d814278df764ba9d64722ed5dc93d64b3d2a6172d7ab995ca7be13c3b160ab73748d52683792563c793f1bece8d731a45c4fad1fd34fd4abbb5894f1503dbe504f8a9650dffb8ada16e21c6aea959b62e33d755e708397f67b91d85f5813311817e35c4a761bf163403c8f7366bf101207539f71a64c2495e0dcc3b14ad2a01b8d66ef80dd71f456f04e1c1964e29839c8fd6b0ab3220e4900240f0eb0e60a2f20655d277a7de6fff05dbf3f340e327fbb30dbe57976334e2a036264c4baec77545f8811ad7972d489fb7918fa64e85a597b0c8397c5ec25b3f55acc857a53e074598642b4188d232b0fadfad6161529c2aa424d6f5169ca7ad42843adc8f029b65d379a9add914c518ca5416e49ba99185a1d2f1db7a7187496c30b10b72b813aeb74231a3d35f27d31f0492159bd5695a43fc125188996b5b3be07d4f1d49f232518e65fc44b37cca83dc6f3997c4bed5536e975fb12a763073087297e581bc8b96bbbde870b4e7ac764e42506b18d5d091ade801016bca853f8cf7811c15368a8e27b4f0d1006d2cc0776007333f11eec2557671387ee1be75d463e53c874b42c5b84952657efd3aa5a5a52f2852694cb8879f0cea157cc3db40f1648023de4e5012e75d17939bbbf0fd61a6d49a88d67831fd79cd7b32b2831094038c957f03c5ef6b39acf92e02aeb737749b7a475ccf8fb90d2048db437895b27a13525b96e0f10c2b2c15d47cb149ab6c5affa9b94c72a062aef0b6ce5819f3a1a89336b92033e904f1029af61245ca036ab8b94f7fd38a172b36720f085d01b599f72898e3e6f98e724c35d6e987324e171c9cd3d8357f41fe323beab1f7adfe15a9cc514e7d5ddff142664c400b9140eda43843f0d2dd284e0137f7df1e859c6641463783486348d25bfea1632cbd045aa5dc7494c46639e0d3e646c4fde50e183c7385ceece39d9edfc14c76f3e4e48f4073eaedfb482b555144fca10016b2618d3b8ac5da30bfa3254f9a72e94749b1965ee2e7547792c9bf6e93810199bcacfc3313ad277f2c1c1151ee2704732e7c85b1e58cb47574bb19ff5b999a92f2b379ea45929f2c8d6916a6852a67d821b2d73b7cda982116e49e0420da71212911f3de0e04f9c4ae6545dea6ba515778881f74aaf803bc4e954798d027eb88111a30a46a6405053423a1655baa7ac9f297a531c5cb7c761d911f6c04bd70fd951a847579870ce0a8d0b98c56df289e72da698b4b8e9c901fc585cc7a87debcff5ac06480f24a4174e8bad822e1292f2d5de416e25bcf4edfa95b771e97b5ef399edcf01bc4a4588f2e58f80884b4fa8b5d54c1c7a203cef76a000ec3c5f0692ca9cb8e38a4fd212719d5776ebecc7981d28324ad1abe8c6b979bf7118df44d5abb235f4b6cecfa301ca54fc0ab37e3108c56208c7d4c64ad9b85f8e27cb4fc34b37b3d6724db46b798cebac0264593390d99056fa02bc0535e6cc866b347fdc4f5f2ae9f9a9f277b51bec46b59c134f2a79d8eeb1b34576816f283a3323e9c2c5624267521f3796894ba516cc45fd3c1d184ba8c10f092cc73be94972054d0858a61a15b4a3ef8caf9bea1d2f808c6d053b9c30093d3ac12a4c6ba71ba6d2664832c442415d8ebe0b7b52870f0cd47c180f23e43c1cafc4365db710063052015066d094e3b5c11ab0eee00ac7f7d84e190f35e370ba9eabe7a9bb627769e1a9d3ea4850da5bda916ad99d037d4ef45ef67807b185bd595299ab40210f6f42395395f494413697abf953d1c2736969478a7d937767c013db4bb585919d061e825766ea71c4cfffa8c3d51671bc6680243aa4ce0051e16ca8d44f05d4220781f7a86544213d0c5cae525f5e7c909d813fff5e95747113b7c722d2f7bf006ddd10d84609637bebbfc19fdb66346193c60a3732abea70ef677047a121c0c64a51e44663d1ba65d9abf489cf609b0642b7b6b753975990a008a8b5ebe59383f122c7f31fec911159c15c5f3a7474ca42de1ec6ccd92a232e0feb19104d0983e5e80c9f725b19ed93e565629c0d3843ded9c19479cb60f0061a323f13f1a0088d69cc50c12b34034af86c3f677bb4cf8215fd1518572023842305b97c7853a072cb3864cd80e4f1f0c2956cf27b4f8303896957592fd13b095f0c47db6c522fbf27ece75f41a3d13f7a9509a94d7f91dfa06e6b58fa38e2b1d5080f0df1a66c54ca0fccdec68e817112b749d2c5a1491eabdcc77c33b824a17a96d19528b6f6cc5dc1f5c68f8290e4f972b1858de76c2f6a27a7c11cadeb483a7e868d14ddf15dc727713f2f9ff9450af10b468104e4d67a39aca525110f309ae375aec12da3dfedf66253b736de30861d8bc2e8629b3035f8af98428ced5b15add324fe2bb90ba176e97422afc9bdc7872cade8943826d4e79d909bff8648d726c9aff4b94753ffefe67ee59e5dc3020a6e8d1e0f0c2cc38229412fcd00109ffac35d0dfc4730d5db9ce9a19db6bec524f0be4141006b4bff5e9ba57e362048342198788b30daaa510f173ba71a3720afd4043577659bbf8403ac940be7d5a4742d2650d3ed011893276aed8423e90398ecc0dbd5f16a063fc462a7c2e2228f489c0463d9250aab6bf452a6571a7396047c5abaf1cfb281ff58535327842c5fcf1124070377641b432e20d0e9816f62b587408769a8e90c44c5de6060e2164da5802dc83b0a3ac6c3a378b2c99192d7632b9bd17d5dc521cc699be01302df0a60e9c880689a5e33716564e9053b2f67d6de192f78f94fef20bd9f88214c9aab8b6d00677e6bac1fe2ac012f4a935d44690b09e3b5044628366bf9d35ae302256ca337ab4d372357ff0d77a859b3981ed6e6c6a4044197b627cc90121a0e6b4450403141c1c78dfa56d6c59661094570c886fbf8c2dbf2d8484da1be6f0833156697b589bc54d041eaeed7a5f54c4406148d5d422ca06fab788949ad30443e223389b66660132e4b2774d819d4c70da9263a25b3c129a09f27a6bfca121429c9bfb7cce6d029493ed2c2bf4ab9b8538ba17dbf0f2c052fe9cc6b8deea153f063875cb59df76c247b5c91481770e4dc2c67b1015c3f31e03f572259f10e9417ed6f58c9744f2a57c1fc44ed4f1af080a47a5e876cb8b53a23f571707f4475d4302608f939b6c5458858dae0d5c0c53496f65547337369d5179ac829ed86d73786c93baf328bc0e281197bb80fd1d1d9edecf9c4d8402aecb6e3082bc18dfcb4c08a48dd3d83288b009d43abec28774de804a0c2efa748bd81f18a3b9433ff3131f7353869fc91eade767da8d51e9c90c42f5f7b28fdc8f9696e7780ab460ab5cc76a35f1fefef2d1c7df095e1268f0dd077508ce20efc7bbf784182e2a4d7e505a30c2619d3d6725d5c1de038d0001790654d9e40575473730a7fab664e9a2217b64f984eb3a147d762a73e91acb91a2fa93ebb3d7b724919545ea90676eb527f25bc6c2dac8e966dbe1ba448450ee6a80b7a504dff81bb729abd0137fff1855ef514ce04b47ad7917774f815f19342472f55dbe88064f18350561b843f0f8d97b7a8847148bc3a3e0f00e8fc0cf40ae9591df79e77a5f3e8a83486ffdcde15ad204fa89bc57c00f97fdb8b68c65fb2a0918a3e4088dbe1e0091d58fa4dbe6bddb9b79f7ecca2c58256bcfe9c515e4e7cfd1c0c22e5731b781006777bbc5728f5077727e50ca1b6ee74d0f2656346c312a5a2ba85f0738d93e71d5dcf178adb9f2486b7827a32d783d4e1381b568f92aeaf8bdd0b14edc9c91297c0c965d333c78abdc55b8463c533364b8b1f8935d0bcafadb181c1b816c8a2979b98eeb9b3fcbe7cb52c6d2af8c403a3aaf3c70c08ff15fd20ae9961c9496dd0055c3b621247d96e0c5edc18ee30914ccef6e024b4c13d95a7acb7a21ab679409a024ce5a2c767f4786c0d515391652820d2781324c31118e41a6bc611faf8b9f36ea108c81f0e3783ad05872b80f2bf8f3890c6ccebe27f6f9da6f45dbcde1b69fd49ebc2d11ae8a6c1ad99733684a0b633bbcc0dda79a0b75adde9e4f3b0fc3a41ea316d6cbd352322156a7acee1c13e46b411c888fe3e6b24f4b4a6a3a76a1cafe05c7d0f259da807df6fcc18492791d3b8f7155d9024748969dee4322b032e8675d0af7715dc5bd5222d7735f0c3b4b5484a560dbf7154a10f7015ed2750eae94b5d837a69dbaf7e7fc6922c2968ab571b1459853ae3093b1cd13da7f4620e8529de795117a9cad8977722414f8ca98beac356730ba6cde3c1c1d96b5748873bf4549751bf19ecbf7380516b56840d8c3858786fd177d1d6e31974dab872985f300c1b7d60a2210c7e0dd242b2e03951f08cb1dd5b2c6b1f417f3dd52dda0ae836b45b4c4096850b4dd342d45393d13a53278919308b74c7d6b45df667a9d9dcf484c6409b0828eff287db686f478968ec6ddb74a7e6d5ef24ef01979240aba4356c3253cc261aa4491de6145235cc19e65195f1f634803818822653cdc7d4696cda3b065288664f17d5f7476051c51ff233bc179c38c6fef8c3819f506ed0fc2ba478a7a824f9d0d7410fd85e119e093ecafd3a9c15f2154db4dd8a8c256c5d7ad1598470616d01ac47a30f34549e1c69d2d877009ad159d9ee747f5721741415d8883f535dc85570717f8efce53b5214cddb27e45822c3ad3021c37fca6ddaeb947fe4eb7ba5f01704b507d94d567244256963c0181636632e23dbae5c9b1cef6745f04c3ca55a4fab219f0b7d59a8000f6d8c6d6c27754df6b2019f2b897b09165578b10fa97f133e042f5a4534a6f82a8913a3cc2796ab5187b5a915730fd3f3875a239dcf781bf207454f2724bdddb0e2da440393756029df69a646691424a975774a9a66c854b36680b3fa52db291b808c40ac83c899d9f916199232f1740f37ed68d37efe6ffded575c554efe9c51bd52e64792379fbf5164d8da20331f94d24e87637528138a0f805be316cbdcfc2fb0bcc94fcde47052d824644ef13cf74c4a87767d91dd6180e5a58772c454576fa50ac06da7a1dd335de50766c6f2f15d01a915d0223cb9d6f67a4a00f6aa607c8ed752f7f8e24f48f1c2ffe4bbf5334f86ad1fd0cdd202841d61ba9a8aca5e50f5d27b1d0c7162ad22c65c3c9e1d709255ee6eae49dfbf2568722b6483648e386fb7de4ecfd57ca1ff29c42dcd2f3c157fb8122b275a4395160b9a838b66773b13c73dc648240087ac3ea382687d6e98c4ee19a965170b769230977f372268a990a56ad04e471497c695f984c3c615fde44a5542ab0dec4020a4ea094c1e0b59a958e119fc8af4420abdc5f4251d4cbb8195a7f58867a895e353af7e7143d5b72976ab1bf70db00731de916f89367f978cadcc3b7288d7f23d27303e8f1cea3e4d532acc6b0dfdff0007c1444f4fdd9eea38971de2eda0da170ac68c097979d8ec4ea62b98f681a38f2328f43717c4828e0b23c221fb95029e810c752aeb17b061e7230a47cdf33fc8b81e417d80ab0e7a1e69f90cc2bb5656fcf87f90faba22220b2b7ec2aed1c283d13fd272a69c9fe14993a495a4a5ea098491eb1a8fa9d1357bb5df20c24b77aea7dbbfc2317b0b2365652b05f3a2083c1356f2640e1a578ba1734728067a0529a86b2413399ec90d9af34c12358bdc8a9ee55bfec9ced027415de8a8fb98f8ed3ebc93b17da627c8f78cbb648cf571ff5911e70f66277aaf2eff0c0bf876b1debfc6db970c72b81576f3be4065adc479a1326e330e751e31d7f2da4eaf313185813c6e5177b9f6b925f32749b6b27e656ec17f5a318719499821fdbdb98f712f81c9a7ae14989f1f881f9639e623dff10f53b5169db23f3b8223065ee34d76395708c5be7882a1039f808b71a6ffdcea28a7bd1355e68a93bcca254e136f2213ac456827194198b0246c33d18667b45015ba66d93dda02ead1add8eb84bae26d7dce1e4326d210c3c8db1ae6f155c9a3cf0578ccc57782b4f80f94651290aaeea9b610b69a5cb5f3eb0e0218ffddede8e102bf48946e11ce5aedfa5618423d7323dd5eb91cf0c190b92684af3824b7b1319962599b9ed5ae218768941428eeafbe93c0034c8be2b435620983e7811b4fad0a46351340ca9145478ddaecbabcaa14fa5b0bac0acdced0d0e79414abc011e700014ed77f1ffd6d30138911a7e6a546103ac0a9d354ce74b3ce968f2837d074631cbb0bddb6c75cadc92d5f96fb354ad74e59c5e1c22771bc460caf6430e54d9bbc5a77dbe7ac8f1027c452a758204f902857ada4830013fc4674721bf9012ac15726847a8d151102ae83ef2d25bca45313a299c57c7c3e1be747c1624abc5e6310211930e760ea5f0a11e9b2f1b6dd2fc7a85af96d09943504170180fdb493eb06486da6c71479d168ebff499d217af6ae7c55d13fbeb3258d2747f66337d7e98ca5bb04892739dc4f399392f21de386376cab50c247b441f21cd55b6ff1470aea567b2fb63005c92215e6c2a64829fd5f7410fa1db7f664f3155872d141a6f38e25e23dda76fd09bb5a747d730e37aaaf5f0def1dd10195e90439c9304d8e1fca66b00a22409670f6dc782445b04526b9b60ac15ac9b0cc6060c3d3714e4e6d7da569fcff4f06948515753a31db89ba2138955ef3035d75c990950e1f0b2622b164bc7d1c4d86ea249ce599c4112d93b57383c751ac981cba011d7d69275ab0274076ca7bc4a99b3a9928e483cbba7e4c36609b3b30cc958a3ed9f0b9a88c0bfc550587dbfc08cf6271e298548dd281520ae0ac3eb815b1cbf61089a06478b590b60f698afd7fcb2c4b58d5e3686dcdfd423aa652af5edec06ac688581f1be81b7b043ba464596626466008be73bbfa432b3a73c77b058183e2c7c602bd6965a71ceffafb41fd496b464a7606cc0b3286626a0b180d407a0732515691e168b71d88699924448906f9449671898ec2bba1096389dc2e77cfd31c67e18e9727c983bd32ea631a6539b5533cbc17865a219620f4259ce1f2231975151c936ddd2e27e8ed0d11c4ca577b499c13b180a31f3539ddaaceee26c33c43d9492a8a8e38df0afec40ee0c79ff44064d7ee88854889abe345fbf584afb756aba8d1cfe09c5281c0f0bb13d20f5a9348fed0918dd075c64d4120bf9fe500dedeabdb8f78d72e175487ba55294e44a3954aa97747e0ad541038c2286e7be62b9ca63a716125867715a73f93f73bebf33fee3125152e66ddc73741f366533c947e478ed79ea138457db077a8c9bfa2f66e5dfe69e681932c6a488142aa7bd268ac8f31308a4d22d2b680ab2e1338408125568702fa5cccac2e2625836ca3bcb70740c25fc3be563097c54b628fcde4c3f4eb30adb58b4e00b520905ea9a09c0c133ea1bce11e47e7ba85e25912b938b51c5fbb71ff886891278177ffa37235cb0a619539588612d09205a37ed1f2a6969c156421477aacfdff207fb3fcaeeb429943cbdb52546b9f7a5bf8cfccaceb8be2002e59f8be1c429e5b471ae68bae3bf97bc6a4a0ac22dce09f2ca54ae71e144e704729bf3d2e4da36c60c44f4d4bbf3f4e855c8405cfc13582feb7c1f864540333d895866052a960c74c4322cec1c0c09e0092834bfa3952bcff6c6dfaf47c5310933346eaec6ee1a9e020208bd150fad5963dd78125508c0c07126b1420c8392fa6629014a19e4bbbf9c726be5b46a823962d4adf3b19d42e03545d34704185b6e421113599308505128e22ab11d59ce6abee5cd66bdbab4eebdda6e817ae59629f4e88c3cd4104cf7e2bcc414f0417f4451b3cff2aa590ee2100728dd2c9b15c1f07f3ee2cfdb6f1c88e0767c685f142a7b928003dde172ebe120d842e76c089a9eb7a0a7d796130545b073c8c52fab1f8a2897302cd2792e673efb8cb22e742b32741c4d23f82deba50ef73187be20e55a44ca9126315b5f8550257fa639896f3e5f02f9c2968876d32723a886fa7ae683221af01eb9943b0a75713a2d541f254a3d5afdfa68b43b51a1f46bccdeea826d89e64ac6426adb457e8d1df4992f20b362d2d7908cdeaf7a664a758d76947363b69a68a32b73ad5c922dec825fe8850ae960643b0b85393a7da437e5ae952f94baf92333fb9e9a79451100c01d217a762d95694799166c1f9952086b13bd944dec21fb297e94773b3979d60f49d733a2728c1f09df80efa124eb7706ed3b9ee6fbd1740a8b82678504702f738c8ca8d2e8456dd6baed1794d5f7681a0a8c392887df61857d9a8da1a34322d25c6742320c316f674e674625ecb2b1f1c90d045fc40d5b6f30064efa05621dfbf2b8cc9fbb89ce4397d02ad559df21bebcae155d64e41f2a2096b0461773c6fc363362df7564df0cac16bdff1aa6f331b2ca7b5e8214723eec08cabac41163bc4e66959a8cb6774825288986331664f70cd45d381d8bbe24149eec0257627625259a00ad45acd7bc1cf7a94c83b35f218eafd1590ec121831f5ec3dc9cd0f9b14b39df6b3ab359ad9ab3534c7b5de4b4428b097163cc17a61d81c424eb90b83ce9081207a6602e734ac67687fb2f788fef7dacbaa9973b57bae1373c0cdc29be7f773a71464324a2aa62c70e738acf320f6976ad0a1237453066c143413586254641c96fe891bb1096685207ec49333c137921dcadb2dc269a3501d2108938a724ac8b578dbbf8f3cc8aae0fc0bae60e9566e59fb982f2c8b39aa7dd76a77259c01f698271b6166675af72968808417f3f614e43eb1e31cffed7667ecc33cd159fce91c2d8c34ce8f8aaa82f0315229835d465e101c3964166d0a970a9271a8ecc4a9016db61b3b4bf6008a5f85aff2b54406c39eed829c460b6987cac11fb78354b9078445f8408daf61a075f5bbcab714350df9187340c01f55224f2c954620fa84a41aca1f55b3655ca479eb84673acb61a382aaa31c48e7f1a9fd4f081d6bf355c0f43be75e9eaeb9efd3f17b26c25eb1f7acfe4e7814fcf48b2909c8f006beb63cfbd87dde62c62681ef4de5f8fa024508b18038003a8f35bca463443650fb0a7854f35bb5191ce106b5302a295ffa11ada7c82b716cd9d0454f6e3de6d4ed23579ed3f82d01786174c088ebdc2011388a56cb0e1d581264e206f1400b95a3b38a46b6b519018bae9812146e5ba078522e2be60421a8f9b03fd6589681b2c6a93236e05f10076ac7f98f5c5b332da1cbe81eba63386605c9743fcf31a300f186380b815aa87a08b718df731502daa376004ad17ce1174f953a83510fa670ff8b4ecb21ab0af1f3502bde85d9350eed0f3c4bfe506f7e4751d927eb6b859d9270301f3e37c2c8331d289569887cda7748941f602da6c235b57081550d9eb90b856b52786d2046fd2a6e67662cbebc32e4916d72361f6bd38b9383d636f7983e5841e0b2c54bd09397c5e9a985b32fa983483b090aace159fdc7ec9819a527ff79984e0e7271dd4ac0ac1ad8b3805c0fcf4ff335a1cfb99b1975aa11f13795877e0d38e74c5e06d7219fa6882e2c01ae7ec3ada9ebf99e1d2672ec318330995868d5018ceed71e3530ebfedfecceca792c6b4058401d0ad9138b530237490191e54a4d5c56f6c8a2eb770288b6530869fc31cceea8b76bd63c41796682b8f9ac47d76fbc8e3f9365c83002d173107c649844dab62fcc2b36df500a75f73b73dbe0889773d26359c338cb3929fa8a9a76b51afc428f9ab8c21dc592c552a7561a2dc2c2aaa98c36bb1a0b8ee65097066fb8168755170e6f711d94da6ffa3c12707bd9c9129590a1c613a6675732f5274e8dd3dd974c9401099b09a779d4f4b89bb011a5149a64e186ec1d048d792e0b20ecff2ac2f7bc1e041dbff92c7d7c0f159818affbf36ac943dad8ed25a711effd67b7b6bff9609e9506e7e0e98cb47b451e7f5d082ed250bc1a9684a14d02b68555791ccc64a57d6fe588c404f8b115d94721bc07f8cb7b116faa8082e627878a70f788cc35a49b26981ff1172bfa4d7dbc6c9d91b8294312c6289186e10e720258225264b4f5a68c59cca363eb6dfc04124d451ed4700317372d0ebf934c88aecca46d36389fbadafa1636ad307485622e8e839d02c6ce0d48664c04797fd3249e87c88180ed69288d66733157bb296c836b0e301b2a63d66cdcb3ef0e2e4ca038892aea500ed0611fce5be5f6aaacf305b31b8adc34678b72842eaeb80bed4799aa90b32116e30e1b247499e3c0e71cd9a551e888d3aaa2bfd21f42260841ca8d99deb48bcee8e9d578fe07b94b49f8f17514a984c2a19c8ff2f3267564676000f83978fddcd266eacf0d8aa10e48f2b288bcf7652a793a54af717f9542367b52c3ce83db8d6de9732dd3a6388330ea891451b08c3f96cc0d52c948b3e1c782bf8233e960c4af0d64c4660aa4c6980dafffa32e36e8f907db425f9328c0b036874909d4c3cd8d296471c34e3c0617d7056e35aa301a5a4d40c9250aa50c7e9a0afded81685c97bbbdd7384185daaf08f8240e63ac48801710f7247865fae85a0b3bc8d845a4593182850af13682dea9a072fdee885101dc02e5f27563d3f84fe57fd38f8162f287803ddbe15efef6efb6595a40695546ebd9d4f2b352d80b2c0d7a1d8a334d5de946c238e87275fc0f25d05574efc4890fa134c4842a2e8f555ff863d42519264b9d4dab70236a18360040e119b06c87ac36e7fbf4f94ff05de0fe1e7966e753526495b7575060ab5bdc7d9cd1f35a43abca85dde3f34637a1c19de7b627d3c245a1e1bdf10d5afed8857a687a47c7ddf92cc76fa9c563fec5771b0c8a6296b84fca650a3f464cb9de1d8a5fbc830c022cf70d3a8c3ad73f0a8fdf2bd69bc9c348b8681224c2741a6c9c648038448894520c146e6897d89b5dd13bc4bb33248cd7ddd1cd4b16fca1acea13d0969cb272fcb2fc8fd3a0964e062cf306e09539225adec540fcbed4d56ea46dd8c0545b6efdc809eaaaf8afd3f3abf06bef714be0c7fdf81374646d6b5b9c36b1148de773a8e540662c21d9ef95b8c771b33cc423a9778d9d7e88814c41603f959146759a70b278d262fd1fa3a302e5e8f8a12f6f33ab96c322e0d99394f04a15d05234b52624634beecea6b83173ed010e900e0851143f70885be950de89ad2919e4237f614b4d9d631498949c41545a40c855c69bb5493889742576dbf77d7e95e45a6476b1fc20048a0e2427ed34ee3366222316e253487258a2369147eee40de60fe32b67374f128c448e0fe44d879056728cd8a180185ee81d8291e9a6ccb462eb7aca93623b2ca5276c4c56a6a2f15bd627a35249aa63cd29f881fa42a9b57d328b17ab3655b85809c99ac0d8ba9d963c67da123cd7047eafa414fe8b04cc4c83af8ff08cb98df91efc2c3d57a5039c389b1c6e86fe94064c5c03d7d72285de29b179224c85c02a13611354b6440f677bfc3113a3629dc552936bcbc148cff72b651b945ea07b9c7a08d37b1261d71c92778d1e2fe63ec6d4731e7b925564ee8f4a7dda0e2ca1790936e81199fba06ce1d95a4925ab84019f8790b85c5fdd6652d5e57be89043d97181ae5297e4bbf7b15b387ce972792cc1d41846704b9285595d63ccaeb1764796ae4ea2251badef864b6ccb9e7587396ac89f0b5a2bb3a267f78304c304c6491a6763f14979a3e8eea5f40a4388ac96f64990dc91554a5dbf651b47636de4a5edbd43e3af5450a2665471c4967c91187f363b32c8839189fef8135e2427a4ceab997bce1132dd081e00719e49e1f0f6d9b0e74f0834f025296b469172a83787d0062f7abdc2275d776be2f264093a09ff8ca25a1fd38af75bcf6b46d0d920318d896a9a41a7e106c58e65b19c95c7b96cc0d439274ba023898564bba84771118db4d93a624abd38e26c5d6c96a4b7fd194cacae8f274d603ed5b08c9f47ece2062f5a38bf75d5e106e6c74093e267ee7597c8ca4bf3d7b47abe023acb9d32be4895d5f8a84fa7890b5429fd6a993e15ae43c880f45e4b1137bdc540ad36449e9a184d8fe1c88f91c1463c5b3278e792ae2eb3ecec0e79ab8d832627ce9c345281e914b3c4f721451db1703f216a23dc8e1e4b2def41e02fa095c8d04665dcbca27a0da212283714f7da0aeee11d9425e3728acc3ae1209bbb6b3d7cb0d2f072e8c7f278d9d6c6b77ac1c4796a8c0f5b4758ea92e766396cc9866f3b48889210977bb637c5fdc2e48b1f85337c0be451c9452043bf28d406962e350a7b230aae91462e39976b25bc9a22b30a5c93726a224eae81c5febeb7f2c9fb4002ddb03f5579c95f463646ebc8698c839f471d81dd50d651b22a6e4f6053438ec8d49949c9a4fe734181b0e0557a028f8a3363e96b6bb96e252af6a4d29bc7c13635bc25442d20803c301cc58c8463020891c4e16cd0c6bbcd40134458d1167415d09d7020473bf92618fc8ef400952c124829c363fe18891b51af06bdc0085f389d3c973fa6a65b25f74fe044f663845c09231fb2dac67917bb6cd02fecbc919288fcbde3e806b0b3434354cd1044c06e7f27779e504b445a8f9fe277b84e1832588da14a2f997581e1249d7b4934f853b40f868028754e4ce0e7d881dbff371dfb08445b5be7f77ad5848547e4416fa333e5458e5166525efb604dd8a8a86bd9e8bc529afe89ddcb3745c39b5bafdcdc43dfaad7cea1bfffe0cbcf35260c341a0579e29dc7275cfb3201c2f8e5c319cc57bd1f19471f52ad9fb70a5cd7b98bfeb8545cb1083e612a8ca1b452f07f43e01fc999207a84269f3d2b210336a8bb6018f3742e8f736e98f6a20388c44d0ac16170218cb680ffcee4ccca8b68125b558338da6c5a9a8aaa03c34af1b3b989e7af16d87ad71b1d7e7620c1a5801a6bac49208a1e61b6f49820fedd7dbb078747e0e1c45e6b842976e2cbee611f097ca39a527cc7e3bf379c0356b468a2fe59bd164447d0982bb7fe028d35e75f2298a5f1c7a33b67c556f7f68b7bd9ce1bde6efdce5e9ba3c18677d9446624535aab2e0952c0160bd896d8ede517767764b4e11459ff45ca8b54b1150d35f02726833f4d0e0d83e80d7540982ad79018446058b5d134deccc503ba0e8050d2d64d7a48424d3dffd4e5e375f8d1d4fd0f553a329bbb40595edbc878e846bcdfcde7021f03dd2edce7a23362ac92e82eb6da3026d16cf3c41f96e9eba5c42716666fea0662f2f95d27e3e76654d550520dd61b56a791cb11d8c3d0a45084109cd7cfe835063deb252b310fc5ebcd26d020330dc94522a955d6643f1c6a86d8a40022c1a8f43a2a3a09402cfc81021d2c9e217639d140b9be3f7df76d59ac636751858f488d39b3d0e5e5d0f4a2c32b3e375059f27d7eb85abd274aadbeffccee8edeec5a971e780c2248d97a4ba2ad30112d83b229f6f874709de909feb7d5d051fc242e3c196d15840d2d66c88fcb79e302862ef629da2ef3e8ab9856462ff940298d073748c4ed283c6364df074b9ad48203a241106048721b8628d30bc72de6415158bbe1c8cfdacb095f0a50c17bfefde84c05874e76c464bc7fa7081a28c8e8a5ac1b120ff5d3b8edb4a2d7f3aa6a39a5323bacd9ff25225a6f3744d95197b8407ed11eed11ce1d993ea045dd56b7212595e6d5e24129b71bf1613939ed256fe59a219160d93a477c86ffd3e2299633ae70f7e63cc03bca6ae1a34c2c0e4604c4a24cc37c22f4a3dd66add61a0023bab324751753a0da51066e2a584a3334620c69a79d1be3557fa0b5451dc7fc7f7bdff070e024c2790ae58dd09fe2b373e5287e795e99787edc6d5ab1f052de32c25ca54e4190b2bb57e0865a85974ea8f204b1debedd7c0832fbc02a5cf62be1ee46902b9d14c1d55456d3de8af75b99edeb8e8528764894f024e52db4db15b44178e1e3ff29423b3ac58fc5b1ed6ddd5d35cdfa19de1382b2da02b6dd1469a5e324be8c42f2312b5eb5540dfd4c6c9c5022b8b922ae2776acdbadd91f3b8ab2199f36daf67d9f84e792fd66bd60fac61de2b50055f9e0a66c5622551c6cbcfcbf3e26b70dbdb486964f84a27118745467a1648942f688b5d2aff4fdf653c7494ba3ff924d9021fa636bf1c769678108ffff51931237ea0e0430340b2e124e157fee53a36005d861e6a7f43d698ba36bca69cd440458f2fe7f2648f8fb7343b0841311a6b0ba663b90e21c075ff08bfe70436dcfb2cd2f0d1fa2443f36c83f044905be40168d274b75b22a2514f08ca028a331583b4a7646bc1335ed24b532a337869abe26ee8dd4dd7c108479c5ed27abc0fc5dde008b24d2dc533257b9480094af6dc78000a3be4aca8bc462ba152a5b0c6c039caa3bd96d9842d39f5b4ba3744377a10142bff09d932eb7e5fc80cfb92f20303ef32471b5f224458420ade950a70437aa0c351625013d7c4fb1615de7578066c23048af38b3fd0fc2a9843cc8ce4bedd76e78d3682ceca5e583be361084c8a614070136844e2c8239510314062b25b1463e5ed1479bf74d73d2797df8dfaa4ba7977905b1b31f6383770dae98a5cb4e682e76dba177e9f63886b976bf492177f30ff7346490818f4ee96eb24e4f5e476f0fb014442c5c2cee310725d60c435e6f8f1a59fadd0f97ca06655982335d6843d5a3c539091e80194e0444ed05ffc448812a9c6c7d03cbca1510e9e981c85ff93e9af6a7d122723b7d72b770034e2e4c35a060c401b7602e051a9e9a18cb834deb64322deea53e3221c9b7076e46a1321599a60ea04e736cc0923e89773a71fcab444d7d6af1b29fbda30c3755eace89cb7946237c3f767202dd571fd537d615858e016cd73e1e6cf857831aa45b6649abce832d84f423744fcff6b5d2ddaab3461ee7be27170ecb2d83615f2b62c75585208ccafa8555e39fffad2f7fc9ffe5c50435aa950f5811a3cd84155dcc9087bb9e377f4a9ac6d718e832817583b1a845b2167ea963bd2126d0f870f12948c8d90771853a66d33a1fda43e26ba1c97ed956d68987398caae63baa8e65fd8110a8e7a1d2ab19a37c96e0c7b877f3a51a86481c386132b0425b8637894f47aeba6d1461ec5035beab4eb1eff05b1dcd35c389c757e592301cd29aa64df4d71a52c25da8d8f70f0b8baedcb75464b645749e4b9c005f45b45a5bdb7d4448e81dab50f6575014c38332219d507415c56e8cdd7d8e5b5b1b1c4185567128cf4851c520b859c40e87e3e4ce9314c9b1201152b6a895349da595f93c46de9b1898a5903438a405b55d65b38ed5f4567c87ec45b308e921e2a27f2f364a172b78bf6b33b35e5ceea3acc4410c7e48b73ec10c2900a391dd06c672b0edadd2cdb922dc301ba3aee7b8e25deede05e42d801999311b32dbe4ce5c18470ce2bf53c02ef84dbd86382a2dd91e753dcbb00f4a781a5adb510e13c95b5d3e7378c0222159e1ffb2992069eff6e10dfe13674798b2c2b9490e5f9efc09f6513d6ea4193412c780cfd9a878af11a15c1e17bee5d6ea10ee88ef9a3999518256300960015dec13344d1905b8ba441ce46e4eca78eadfa7d8e2aac875b08ec91e41713c22a8323716568d8e58146e80acf7999754ba35241e6059fd62c8c5fbba4f40e2fafb5679637b93efe2bd4723f30409efe4d66792b27eaf55963f46b975177021b95e7781136fc32a104cd4eaa99af2307e4d4cb571c5fc0ad09ac9d877759aef438490358e007b17ab2905981ba0d722f4852a67f83b7ec48fc1831a9ce55646f1aa4675f26b3f8470448e05e0621bee204d46e7b134974624eb1103e8d2775932cd81d8a757b3b19373e5b25713404fe2e1fbb86eb35501789328af1fde33dc530b193d1ab44cd7dc936a2615e33b29c020ff5184e7731a7fa1600368b4ef514a974f18160ad3d9e9538a6e9f2e33f6ad216a8b09e9c843f22160e974a35830d3c1c49b335ab9ec8df9fa42e5b0b95519b85b71d90af79e21567203fea4cdfc28290cf671c2dd9b56e9dec347e0d6b80bfbd52223b17fd6b1b34220e747a03fda8a045bcc95a820cf9f261ee7ed164efc21068b15b63e59b4b5639f7ad30def48e68e76bec4bb307b8684bc51494b97993c68fe23a53a75d8d51aca3b890908b00073613bbd4b8c6e5b8cc42c8bda2c3a37b75485e905181df178705dc588e119f16fdcf2bd107afc60fdd15e837a9d033efa286456bcfdd55e4fac7c1c0db54722b839f5169b4155ff9890804ddb43748b47a0f79935b4702f50c7c91477655ce0bb4e21e888b702f8164dde518e796356586ab400204a37aa53bb5937dee98ba289c70d514bb064d8f4743a64c274ba152a689957ce4a06054dcab6cc72ae5b07f4dec226e1f4fda7349835209ed178d62d4dc99a6465600de9b8d9f8b5fab8f62fa335705e4f9addee1a27d782f6e99bbaaf168de3e883ab84c3845fafbab495c2240039a4b772f55182643ff0d38c476aa5500198e451fd59a3faf69b2c3a8705196c494e74b1bae8f64ef7356cb7c48456b9281f9a640c7bdf794b688f8b39b4543e0d9b62af740d65544d3c5bd9b8a853056823b616de160e4c13d330b74e1b00c98838643d9471c0d8b91897d542be32dcd5e0ab3d7b8f159044d69663220265fb959cb936864dd3ea584d27988ebde8b803af68537d62ca1e9db9faa53300d069e1c2d90084aa45ec54206ac426cbfe1c2c77130d22716e37f1cf7751dbc14ad431f36275147991fe11a70c0b6ca2f623052ce3f2392eb7727840cfeb060d9d89422827e4486976b7a2f4675e19d996027d5e79902ac5d6fd1e53655db1e2a368e58daba1ceeb4ae55c27cb9bd754e846e8cd563dd7ff7674ee5b11194071c4188fbc2104ea3fbe7d41fb45fd097bebc1053d270ca3f2933fc53a7d5bdba041e3bde64553da82a196068a01a69fff6586163dc1f9318f1924f5ef110a8073b4a4f2ab002269c03ef786488fa30e39a648d8254ab36af5c8c5552b60365ca52be9d7d4792595733677055493d41719bac24cc62742cf7604b2862b5acbc3f104c90cd134a958c5054b2a1d67c0c2e123f6aaa595059007ecf0a5809bdefbcf7b8ccc7d20378e0a335735f3766e05b7d17a0122a8255f1097e9feafed670c75c34fd92120ebce20df273d00775b8057d2c8cb52bd1c646e8e82b52ba7955a1a3f9643fea29fea93d23786f7c88f88f4c6c37b1be90167"

-- Helpers
local function hexToBytes(hex)
    local t = {}
    for i=1,#hex,2 do
        t[#t+1] = string.char(tonumber(hex:sub(i,i+1),16))
    end
    return table.concat(t)
end

-- Minimal AES implementation (pure Lua, CBC mode, PKCS#7)
-- For brevity, you’d paste the AES decrypt function here.
-- (There are open-source pure-Lua AES-256-CBC snippets you can drop in.)
-- It should expose: decrypt_cbc(cipherBytes, keyBytes, ivBytes)

local AES = {}

-- (helpers: xor16, pkcs7_unpad, Sbox/InvSbox tables, key expansion, decryptblock, etc.)

function AES.decrypt_cbc(cipher, key, iv)
    assert(#key == 32, "AES-256 key must be 32 bytes")
    assert(#iv  == 16, "IV must be 16 bytes")
    assert(#cipher % 16 == 0, "Ciphertext must be a multiple of 16 bytes")

    local out = {}
    local prev = iv
    for i = 1, #cipher, 16 do
        local cblock = cipher:sub(i, i+15)
        local pblock = decryptblock(cblock, key)
        out[#out+1] = xor16(pblock, prev)
        prev = cblock
    end
    return pkcs7_unpad(table.concat(out))
end

-- Decrypt + execute
-- Inline AES-256-CBC decryptor (Luau/bit32)
local AES = {}

local function xor16(a, b)
    local r = {}
    for i = 1, 16 do
        r[i] = string.char(bit32.bxor(a:byte(i), b:byte(i)))
    end
    return table.concat(r)
end

local function pkcs7_unpad(s)
    local n = #s
    if n == 0 then return "" end
    local pad = s:byte(n)
    if pad < 1 or pad > 16 then return s end
    for i = n - pad + 1, n do
        if s:byte(i) ~= pad then
            return s
        end
    end
    return s:sub(1, n - pad)
end

local function tobytes(s)
    local t = {}
    for i = 1, #s do t[i] = s:byte(i) end
    return t
end
local function frombytes(t)
    local s = {}
    for i = 1, #t do s[i] = string.char(t[i]) end
    return table.concat(s)
end

-- AES constants (InvSbox shown; Sbox identical to std AES table)
local Sbox = {99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,234,101,98,186,8,200,140,136,162,207,109,55,102,12,61,36,173,15,23,68,143,2,190,6,25,89,119,177,63,179,37,114,65,59,85,224,11,45,157,147}
local InvSbox = {82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,214,210,71,240,173,212,162,175,156,164,114,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,234,101,98,186,150,20,252,227,73,96,195,186,20,218,132,185,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22}
local Rcon = {1,2,4,8,16,32,64,128,27,54}

local function rotword(w) return {w[2], w[3], w[4], w[1]} end
local function subword(w)
    return { Sbox[w[1]+1], Sbox[w[2]+1], Sbox[w[3]+1], Sbox[w[4]+1] }
end

local function keyexpand(keybytes)
    local Nk, Nb, Nr = 8, 4, 14
    local w = {}
    for i=0,Nk-1 do
        w[i] = { keybytes[4*i+1], keybytes[4*i+2], keybytes[4*i+3], keybytes[4*i+4] }
    end
    for i=Nk, Nb*(Nr+1)-1 do
        local temp = { w[i-1][1], w[i-1][2], w[i-1][3], w[i-1][4] }
        if i % Nk == 0 then
            temp = rotword(temp)
            temp = subword(temp)
            temp[1] = bit32.bxor(temp[1], Rcon[math.floor(i/Nk)])
        elseif i % Nk == 4 then
            temp = subword(temp)
        end
        w[i] = {
            bit32.bxor(w[i-Nk][1], temp[1]),
            bit32.bxor(w[i-Nk][2], temp[2]),
            bit32.bxor(w[i-Nk][3], temp[3]),
            bit32.bxor(w[i-Nk][4], temp[4]),
        }
    end
    local roundkeys = {}
    for r=0, Nr do
        local rk = {}
        for c=0,3 do
            local t = w[r*4 + c]
            rk[c*4+1], rk[c*4+2], rk[c*4+3], rk[c*4+4] = t[1], t[2], t[3], t[4]
        end
        roundkeys[r] = rk
    end
    return roundkeys
end

local function bytes_to_state(block)
    local s = {{},{},{},{}}
    for i=0,15 do
        s[(i%4)+1][math.floor(i/4)+1] = block[i+1]
    end
    return s
end
local function state_to_bytes(state)
    local out = {}
    for i=0,15 do
        out[i+1] = state[(i%4)+1][math.floor(i/4)+1]
    end
    return out
end
local function addroundkey(state, roundkey)
    for c=1,4 do
        for r=1,4 do
            state[r][c] = bit32.bxor(state[r][c], roundkey[(c-1)*4 + r])
        end
    end
end
local function invshiftrows(state)
    state[2][1], state[2][2], state[2][3], state[2][4] = state[2][4], state[2][1], state[2][2], state[2][3]
    state[3][1], state[3][2], state[3][3], state[3][4] = state[3][3], state[3][4], state[3][1], state[3][2]
    state[4][1], state[4][2], state[4][3], state[4][4] = state[4][2], state[4][3], state[4][4], state[4][1]
end
local function invsubbytes(state)
    for r=1,4 do
        for c=1,4 do
            state[r][c] = InvSbox[state[r][c]+1]
        end
    end
end

local function gmul(a,b)
    local p = 0
    for _=1,8 do
        if bit32.band(b,1) ~= 0 then p = bit32.bxor(p,a) end
        local hi = bit32.band(a,0x80)
        a = bit32.band(a*2,0xFF)
        if hi ~= 0 then a = bit32.bxor(a,0x1B) end
        b = bit32.rshift(b,1)
    end
    return p
end
local function invmixcolumns(state)
    for c=1,4 do
        local a0,a1,a2,a3 = state[1][c], state[2][c], state[3][c], state[4][c]
        state[1][c] = bit32.band(bit32.bxor(bit32.bxor(gmul(a0,0x0e), gmul(a1,0x0b)), bit32.bxor(gmul(a2,0x0d), gmul(a3,0x09))), 0xFF)
        state[2][c] = bit32.band(bit32.bxor(bit32.bxor(gmul(a0,0x09), gmul(a1,0x0e)), bit32.bxor(gmul(a2,0x0b), gmul(a3,0x0d))), 0xFF)
        state[3][c] = bit32.band(bit32.bxor(bit32.bxor(gmul(a0,0x0d), gmul(a1,0x09)), bit32.bxor(gmul(a2,0x0e), gmul(a3,0x0b))), 0xFF)
        state[4][c] = bit32.band(bit32.bxor(bit32.bxor(gmul(a0,0x0b), gmul(a1,0x0d)), bit32.bxor(gmul(a2,0x09), gmul(a3,0x0e))), 0xFF)
    end
end

local function decryptblock(block_str, key_str)
    local block = tobytes(block_str)
    local key   = tobytes(key_str)
    local roundkeys = keyexpand(key)
    local Nr = 14

    local state = bytes_to_state(block)
    addroundkey(state, roundkeys[Nr])

    for round = Nr-1, 1, -1 do
        invshiftrows(state)
        invsubbytes(state)
        addroundkey(state, roundkeys[round])
        invmixcolumns(state)
    end

    invshiftrows(state)
    invsubbytes(state)
    addroundkey(state, roundkeys[0])

    local out = state_to_bytes(state)
    return frombytes(out)
end

function AES.decrypt_cbc(cipher, key, iv)
    assert(#key == 32, "AES-256 key must be 32 bytes")
    assert(#iv  == 16, "IV must be 16 bytes")
    assert(#cipher % 16 == 0, "Ciphertext must be a multiple of 16 bytes")

    local out = {}
    local prev = iv
    for i = 1, #cipher, 16 do
        local cblock = cipher:sub(i, i+15)
        local pblock = decryptblock(cblock, key)
        out[#out+1] = xor16(pblock, prev)
        prev = cblock
    end
    return pkcs7_unpad(table.concat(out))
end

-- Decrypt + execute with debug
local plain = AES.decrypt_cbc(
    hexToBytes(CIPHER_HEX),
    hexToBytes(AES_KEY_HEX),
    hexToBytes(IV_HEX)
)

print("=== Decrypted preview ===")
print(plain:sub(1, 200))
print("=========================")

local f, err = loadstring(plain)
if not f then
    warn("Loadstring failed:", err)
else
    local ok, runtimeErr = pcall(f)
    if not ok then
        warn("Runtime error:", runtimeErr)
    else
        print("✅ Script executed successfully")
    end
end

AES_KEY_HEX, CIPHER_HEX, IV_HEX, plain = nil, nil, nil, nil
